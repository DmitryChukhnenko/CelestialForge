# CelestialForge

CelestialForge — веб-приложение для краудфандинга с полным набором функций, разработанное на Java и фреймворке Spring Boot. Оно предоставляет платформу для создания, управления и финансирования проектов. Приложение включает функции аутентификации пользователей, создание проектов, пожертвования, обновления проектов через блоги и этапы, а также социальные взаимодействия, такие как лайки.

## Основные возможности

*   **Управление проектами**: Создание и управление проектами краудфандинга с заголовками, описаниями, целевыми суммами финансирования и датами завершения.
*   **Аутентификация пользователей**: Безопасная система регистрации и входа, реализованная с помощью Spring Security.
*   **Пожертвования**: Пользователи могут жертвовать средства в поддержку проектов для достижения целевых сумм.
*   **Обновления проектов**: Создатели проектов могут информировать своих сторонников через записи блога и этапы проекта.
*   **Интерактивный контент**: Пользователи могут ставить лайки проектам, записям блогов и комментариям.
*   **Профили пользователей**: Настройка профилей с возможностью загрузки аватара.
*   **Загрузка файлов**: Поддержка загрузки изображений для проектов, профилей, блогов и этапов через сервис объектного хранения.
*   **Динамический интерфейс**: UI, отрисованный на стороне сервера с Thymeleaf, дополненный JavaScript для реализации функций в реальном времени (например, лайки).

## Используемые технологии

*   **Бэкенд**: Java 23, Spring Boot 3.4
    *   Spring Web, Spring Security, Spring Data JPA, Spring Session
*   **База данных**: PostgreSQL
*   **Кэширование**: Redis (для управления сессиями и кэширования запросов)
*   **Хранилище файлов**: Minio (совместимое с S3)
*   **Фронтенд**: Thymeleaf, HTML5, CSS3, JavaScript
*   **Сборка**: Apache Maven
*   **Контейнеризация**: Docker & Docker Compose
*   **Обратный прокси**: NGINX

## Архитектура системы

Приложение реализовано как многоконтейнерная система, управляемая через Docker Compose, что обеспечивает разделение обязанностей и масштабируемость.

1.  **NGINX**: Выступает в роли точки входа и обратного прокси. Перенаправляет HTTP-запросы:
    *   `/` → Приложение Spring Boot
    *   `/files/` → Minio для раздачи медиафайлов
    *   `/pgadmin/` → pgAdmin
    *   `/adminer/` → Adminer

2.  **Spring Boot Приложение (CelestialForge)**: Основной сервис с бизнес-логикой.
    *   **Контроллеры**: Обработка HTTP-запросов к проектам, пользователям, блогам, пожертвованиям и т.д.
    *   **Сервисы**: Логика приложения: управление пользователями, жизненный цикл проектов, обработка пожертвований.
    *   **Репозитории**: Работа с PostgreSQL через Spring Data JPA.
    *   **Безопасность**: Spring Security управляет аутентификацией, авторизацией и защитой от CSRF.
    *   **Сервис файлов**: Интеграция с Minio для загрузки и управления файлами.
    *   **Кэширование**: Работа с Redis для кэширования данных и сессий.

3.  **PostgreSQL**: Основная реляционная БД для хранения данных: пользователи, проекты, пожертвования и записи.

4.  **Minio**: Сервер объектного хранения для загрузки изображений профилей, проектов и вложений блогов.

5.  **Redis**: In-memory хранилище для кэширования и управления сессиями, улучшающее производительность.

Репозиторий содержит `project.drawio` и `classdiagram.drawio` для визуального представления архитектуры и классов.

## Начало работы

Следуйте этим инструкциям, чтобы запустить проект локально.

### Предварительные требования

*   Java JDK 23 или выше
*   Apache Maven
*   Docker
*   Docker Compose

### Конфигурация

1.  Создайте файл `.env` в корневой директории проекта.
2.  Заполните его следующими переменными (значения можно изменить):

    ```bash
    # Порты приложения
    SPRING_PORT=8080
    NGINX_PORT=8000

    # Настройки PostgreSQL
    POSTGRES_HOST=db
    POSTGRES_DB=celestialforgedb
    POSTGRES_USER=user
    POSTGRES_PASSWORD=password
    POSTGRES_PORT=5432

    # Настройки Minio
    MINIO_URL=minio:9000
    MINIO_ROOT_USER=minioadmin
    MINIO_ROOT_PASSWORD=minioadmin
    MINIO_BUCKET=celestial-forge-bucket
    MINIO_PORT=9000

    # Настройки Redis
    REDIS_HOST=redis
    REDIS_PORT=6379

    # Кэширование и сессии Spring
    SPRING_CACHE_TYPE=redis
    SPRING_LIFETIME=1800s
    ```

### Сборка и запуск

Для автоматизации используется скрипт `build.sh`.

1.  Сделайте скрипт исполняемым:
    ```sh
    chmod +x build.sh
    ```

2.  Запустите его:
    ```sh
    ./build.sh
    ```

Скрипт выполнит:
*   `mvn clean package`: Очистка и сборка `.jar`.
*   `docker-compose build --no-cache`: Сборка Docker-образов без кэша.
*   `docker-compose up`: Запуск всех сервисов.

Вручную:
```sh
# 1. Сборка Spring Boot
mvn clean package

# 2. Запуск через Docker Compose
docker-compose up --build
```

## Использование

### Доступ к приложению

*   **Основное приложение**: `http://localhost:8000` (или указанный `NGINX_PORT`)
*   **API**: REST-эндпоинты доступны по `/api/`. Например, лайки: `/api/likes/...`.

### Управляющие консоли

*   **pgAdmin**: `http://localhost:8000/pgadmin/` (Email: `user@domain.com`, Пароль из `.env`)
*   **Adminer**: `http://localhost:8000/adminer/`
*   **Minio Console**: `http://localhost:9090` (Логин: `MINIO_ROOT_USER`, Пароль: `MINIO_ROOT_PASSWORD`)

## Лицензия

Проект распространяется под лицензией Apache License 2.0. Подробности в файле [LICENSE](LICENSE).
